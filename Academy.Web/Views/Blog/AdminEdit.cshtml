@{
    Layout = "_Layout";
}
@model Academy.Core.Models.BlogPost

<!-- Header Section -->
<section class="bg-gradient-to-r from-yellow-600 to-yellow-700 text-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">
            Редактиране на статия
        </h1>
        <p class="text-xl text-yellow-100 max-w-3xl mx-auto">
            Обновете съдържанието на "@Model.Title"
        </p>
    </div>
</section>

<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="bg-white rounded-lg shadow-md p-8">
        <form asp-action="AdminEdit" method="post">
            <input type="hidden" asp-for="Id" />
            <input type="hidden" asp-for="CreatedAt" />
            <input type="hidden" asp-for="Slug" />
            
            <div asp-validation-summary="ModelOnly" class="mb-6 p-4 bg-red-50 border-l-4 border-red-400 text-red-700 rounded"></div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Main Content -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Title -->
                    <div>
                        <label asp-for="Title" class="block text-sm font-medium text-gray-700 mb-2">Заглавие *</label>
                        <input asp-for="Title" type="text" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                               placeholder="Въведете заглавието на статията">
                        <span asp-validation-for="Title" class="text-sm text-red-600"></span>
                    </div>

                    <!-- Summary -->
                    <div>
                        <label asp-for="Summary" class="block text-sm font-medium text-gray-700 mb-2">Кратко описание *</label>
                        <textarea asp-for="Summary" rows="3" 
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                  placeholder="Кратко описание на статията (максимум 500 символа)"></textarea>
                        <span asp-validation-for="Summary" class="text-sm text-red-600"></span>
                        <p class="text-xs text-gray-500 mt-1">Максимум 500 символа</p>
                    </div>

                    <!-- Content -->
                    <div>
                        <label asp-for="Content" class="block text-sm font-medium text-gray-700 mb-2">Съдържание *</label>
                        <div class="mb-2 flex space-x-2">
                            <button type="button" onclick="insertTag('h1', 'H1 Заглавие')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">H1</button>
                            <button type="button" onclick="insertTag('h2', 'H2 Подзаглавие')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">H2</button>
                            <button type="button" onclick="insertTag('h3', 'H3 Под-подзаглавие')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">H3</button>
                            <button type="button" onclick="insertTag('p', 'Параграф')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">P</button>
                            <button type="button" onclick="insertTag('ul', 'Списък')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">UL</button>
                            <button type="button" onclick="insertTag('strong', 'Удебелен текст')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">B</button>
                            <button type="button" onclick="insertTag('em', 'Наклонен текст')" class="px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded border">I</button>
                        </div>
                        <textarea asp-for="Content" rows="20" 
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent font-mono text-sm"
                                  placeholder="Въведете съдържанието на статията. Използвайте бутоните горе за HTML форматиране."></textarea>
                        <span asp-validation-for="Content" class="text-sm text-red-600"></span>
                        <p class="text-xs text-gray-500 mt-1">Можете да използвате HTML маркиране за форматиране</p>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="space-y-6">
                    <!-- Category -->
                    <div>
                        <label asp-for="Category" class="block text-sm font-medium text-gray-700 mb-2">Категория *</label>
                        <select asp-for="Category" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                            <option value="">Изберете категория</option>
                            <option value="Обучение">Обучение</option>
                            <option value="Математика">Математика</option>
                            <option value="Програмиране">Програмиране</option>
                            <option value="БЕЛ">Български език</option>
                            <option value="Съвети">Съвети</option>
                            <option value="Новини">Новини</option>
                        </select>
                        <span asp-validation-for="Category" class="text-sm text-red-600"></span>
                    </div>

                    <!-- Author -->
                    <div>
                        <label asp-for="Author" class="block text-sm font-medium text-gray-700 mb-2">Автор</label>
                        <input asp-for="Author" type="text" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                               placeholder="Вашето име">
                        <span asp-validation-for="Author" class="text-sm text-red-600"></span>
                    </div>

                    <!-- Slug -->
                    <div>
                        <label asp-for="Slug" class="block text-sm font-medium text-gray-700 mb-2">URL Slug</label>
                        <input asp-for="Slug" type="text" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                               placeholder="url-slug-на-статията">
                        <span asp-validation-for="Slug" class="text-sm text-red-600"></span>
                        <p class="text-xs text-gray-500 mt-1">Внимание: промяната на slug-а може да наруши връзките</p>
                    </div>

                    <!-- Image URL -->
                    <div>
                        <label asp-for="ImageUrl" class="block text-sm font-medium text-gray-700 mb-2">URL на изображение</label>
                        <input asp-for="ImageUrl" type="url" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                               placeholder="https://example.com/image.jpg">
                        <span asp-validation-for="ImageUrl" class="text-sm text-red-600"></span>
                    </div>

                    <!-- Is Published -->
                    <div>
                        <label class="flex items-center">
                            <input asp-for="IsPublished" type="checkbox" 
                                   class="h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded">
                            <span class="ml-2 text-sm text-gray-700">Публикувай веднага</span>
                        </label>
                    </div>

                    <!-- SEO Section -->
                    <div class="border-t pt-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">SEO настройки</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label asp-for="MetaTitle" class="block text-sm font-medium text-gray-700 mb-2">Meta заглавие</label>
                                <input asp-for="MetaTitle" type="text" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                       placeholder="SEO заглавие (по-добре от оригиналното)">
                                <span asp-validation-for="MetaTitle" class="text-sm text-red-600"></span>
                            </div>

                            <div>
                                <label asp-for="MetaDescription" class="block text-sm font-medium text-gray-700 mb-2">Meta описание</label>
                                <textarea asp-for="MetaDescription" rows="2" 
                                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                          placeholder="SEO описание (максимум 300 символа)"></textarea>
                                <span asp-validation-for="MetaDescription" class="text-sm text-red-600"></span>
                                <p class="text-xs text-gray-500 mt-1">Максимум 300 символа</p>
                            </div>

                            <div>
                                <label asp-for="MetaKeywords" class="block text-sm font-medium text-gray-700 mb-2">Meta ключови думи</label>
                                <input asp-for="MetaKeywords" type="text" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                       placeholder="ключова дума 1, ключова дума 2, ключова дума 3">
                                <span asp-validation-for="MetaKeywords" class="text-sm text-red-600"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Post Info -->
                    <div class="border-t pt-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Информация за статията</h3>
                        
                        <div class="space-y-2 text-sm text-gray-600">
                            <div><strong>ID:</strong> @Model.Id</div>
                            <div><strong>Създадена:</strong> @Model.CreatedAt.ToString("dd.MM.yyyy HH:mm")</div>
                            @if (Model.UpdatedAt.HasValue)
                            {
                                <div><strong>Обновена:</strong> @Model.UpdatedAt.Value.ToString("dd.MM.yyyy HH:mm")</div>
                            }
                            @if (Model.PublishedAt.HasValue)
                            {
                                <div><strong>Публикувана:</strong> @Model.PublishedAt.Value.ToString("dd.MM.yyyy HH:mm")</div>
                            }
                            <div><strong>Прегледи:</strong> @Model.ViewCount</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Submit Buttons -->
            <div class="mt-8 flex justify-end space-x-4">
                <a href="/blog/admin/list" 
                   class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                    Отказ
                </a>
                <button type="submit" 
                        class="px-6 py-3 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors">
                    Обнови статията
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        // Insert HTML tags
        function insertTag(tag, placeholder) {
            const contentField = document.getElementById('Content');
            const start = contentField.selectionStart;
            const end = contentField.selectionEnd;
            const text = contentField.value;
            
            let insertText = '';
            if (tag === 'h1' || tag === 'h2' || tag === 'h3') {
                insertText = `\n<${tag}>${placeholder}</${tag}>\n`;
            } else if (tag === 'p') {
                insertText = `\n<p>${placeholder}</p>\n`;
            } else if (tag === 'ul') {
                insertText = `\n<ul>\n  <li>Първи елемент</li>\n  <li>Втори елемент</li>\n</ul>\n`;
            } else if (tag === 'strong') {
                insertText = `<strong>${placeholder}</strong>`;
            } else if (tag === 'em') {
                insertText = `<em>${placeholder}</em>`;
            }
            
            contentField.value = text.substring(0, start) + insertText + text.substring(end);
            contentField.focus();
            contentField.setSelectionRange(start + insertText.length, start + insertText.length);
        }
    </script>
}
